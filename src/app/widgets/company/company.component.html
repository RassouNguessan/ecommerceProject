<div class="container mt-5 bg-white">
  <div class="pt-5">
    <app-sec-msg></app-sec-msg>
    @if (nextStep === StateEnum.One) {
    <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepOneForm" (ngSubmit)="stepOneFormSubmit()">
      <div class="message fs-27 pb-3">
        <span>inscription - enterprise</span>
      </div>

      <div class="row mb-2">
        <label for="name" class="form-label">
          Nom du gérant
          <span class="red">*</span>
        </label>
        <div class="col-sm-12">
          <input type="text" class="form-input" id="first_name" placeholder="Saisissez votre nom"
            formControlName="first_name" />
        </div>
        <div *ngIf="stepOneForm.controls['first_name'].invalid && (stepOneForm.controls['first_name'].dirty || stepOneForm.controls['first_name'].touched)" class="text-danger">
          Le nom du gérant est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="surname" class="form-label">
          Prénoms du gérant
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <input type="text" class="form-input" id="last_name" placeholder="Saisissez votre prénoms"
            formControlName="last_name" />
        </div>
        <div *ngIf="stepOneForm.controls['last_name'].invalid && (stepOneForm.controls['last_name'].dirty || stepOneForm.controls['last_name'].touched)" class="text-danger">
          Le prénom du gérant est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="social" class="form-label">
          Dénommination sociale
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <input type="text" class="form-input" id="company" placeholder="Saisissez votre dénommination sociale"
            formControlName="company" />
        </div>
        <div *ngIf="stepOneForm.controls['company'].invalid && (stepOneForm.controls['company'].dirty || stepOneForm.controls['company'].touched)" class="text-danger">
          La dénommination sociale est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="fixed" class="form-label">
          Numéro fixe
          <span class="red">*</span>
        </label>
        <div class="col-sm-12">
          <input type="text" class="form-input" id="number_fix" placeholder="+225 00 00 00 00 00"
            formControlName="number_fix" />
        </div>
        <div *ngIf="stepOneForm.controls['number_fix'].invalid && (stepOneForm.controls['number_fix'].dirty || stepOneForm.controls['number_fix'].touched)" class="text-danger">
          La Numéro fixe est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="number" class="form-label">
          Numéro de téléphone
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <input type="text" class="form-input" id="phone" placeholder="+225 00 00 00 00 00"
            formControlName="phone" />
        </div>
        <div *ngIf="stepOneForm.controls['phone'].invalid && (stepOneForm.controls['phone'].dirty || stepOneForm.controls['phone'].touched)" class="text-danger">
          La Numéro telephone est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="enterprisemail" class="form-label">
          Adresse E-mail de l'entreprise
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <input type="text" class="form-input" id="email"
            placeholder="Saisissez votre adresse mail de l'entreprise" formControlName="email" />
        </div>
        <div *ngIf="stepOneForm.controls['email'].invalid && (stepOneForm.controls['email'].dirty || stepOneForm.controls['email'].touched)" class="text-danger">
          L'adresse Email de l'entreprise est requis.
        </div>
      </div>
      <div class="row mb-2">
        <label for="country" class="form-label">
          Pays
          <span class="red">*</span>
        </label>
        <div class="d-flex align-items-center">
          <select id="country" class="form-select col-sm-12" formControlName="country">
            <option [value]="">Sélectionner votre pays</option>
            <option *ngFor="let country of countries" [value]="country">
              {{ country }}
            </option>
          </select>
        </div>
      </div>

      <div class="d-flex mt-5">
        <button type="button" class="btn-custom cancel" routerLink="/register">
          annuler
        </button>
        <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepOneForm.valid">
          suivant
        </button>
      </div>
    </form>
    } @else if (nextStep === StateEnum.Two) {
      <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepTwoForm" (ngSubmit)="stepTwoFormSubmit()">
        <div class="message fs-27 pb-3">
          <span>inscription - enterprise</span>
        </div>
        <div class="d-flex fs-18 fw-bold mt-2">
          <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" width="17px" height="20px" viewBox="0 0 111.811 122.88"
            enable-background="new 0 0 111.811 122.88" xml:space="preserve">
            <g>
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M55.713,0c20.848,13.215,39.682,19.467,55.846,17.989 c2.823,57.098-18.263,90.818-55.63,104.891C19.844,109.708-1.5,77.439,0.083,17.123C19.058,18.116,37.674,14.014,55.713,0L55.713,0 z M41.458,56.508h1.438v-3.331c0-3.689,1.454-7.051,3.797-9.494c2.361-2.462,5.622-3.991,9.214-3.991s6.854,1.529,9.214,3.991 c2.343,2.443,3.797,5.805,3.797,9.494v3.331h1.438c1.167,0,2.123,0.955,2.123,2.123v22.434c0,1.168-0.956,2.123-2.123,2.123H41.458 c-1.168,0-2.123-0.955-2.123-2.123V58.631C39.334,57.463,40.29,56.508,41.458,56.508L41.458,56.508z M54.164,71.286l-2.291,6h8.066 l-2.122-6.082c1.347-0.693,2.268-2.097,2.268-3.716c0-2.308-1.871-4.179-4.179-4.179s-4.178,1.871-4.178,4.179 C51.728,69.173,52.726,70.625,54.164,71.286L54.164,71.286z M46.916,56.508h17.981v-3.331c0-2.623-1.021-4.999-2.666-6.715 c-1.627-1.697-3.866-2.751-6.325-2.751c-2.458,0-4.698,1.054-6.324,2.751c-1.646,1.716-2.666,4.092-2.666,6.715V56.508 L46.916,56.508z" />
            </g>
          </svg>
          <span class="mx-2">Confirmation numéro d'E-mail.</span>
        </div>
        <div class="my-2 mb-4 fs-16">
          <span>
            Si le remplissage automatique ne se déclenche pas dans
            quelques secondes, saisissez le code que nous avons envoyé
            au {{stepOneForm.value.email}}.
          </span>
        </div>
        <div class="row mb-2">
          <label for="otpCode" class="form-label">
            Code
            <span class="red">*</span>
          </label>
          <div class="col-sm-12">
            <input type="text" class="form-input" id="otpCode" placeholder="Saisissez le code reçu par sms"
              formControlName="otpCode" />
            <div *ngIf="stepTwoForm.controls['otpCode'].invalid && (stepTwoForm.controls['otpCode'].dirty || stepTwoForm.controls['otpCode'].touched)" class="text-danger">
              Le code OTP est requis.
            </div>
            <div *ngIf="otpErrorMessage" class="text-danger">
              {{ otpErrorMessage }}
            </div>
          </div>
        </div>
        <div class="d-flex mt-5">
          <button type="button" class="btn-custom cancel" (click)="back()">
            annuler
          </button>
          <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepTwoForm.valid">
            suivant
          </button>
        </div>
      </form>
    } @else if (nextStep === StateEnum.Three) {
    <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepThreeForm" (ngSubmit)="stepThreeFormSubmit()">
      <div class="message fs-27 pb-3">
        <span>inscription - entreprise</span>
      </div>
      <div class="row mb-2">
        <label for="enterprisetype" class="form-label">
          Type d'entreprise
          <span class="red">*</span>
        </label>
        <div class="d-flex align-items-center">
          <select id="company_type" class="form-select col-sm-12" formControlName="company_type">
            <option [value]="">Type d'entreprise</option>
            @for (enterprise of enterprises; track enterprise) {
            <option [value]="enterprise.code">
              {{ enterprise.name }}
            </option>
            }
          </select>
        </div>
        <!-- <div *ngIf="stepThreeForm.controls['company_type'].invalid && (stepThreeForm.controls['company_type'].dirty || stepThreeForm.controls['company_type'].touched)" class="text-danger">
          Le Type de l'entreprise est requis.
        </div> -->
      </div>
      <div class="row mb-2">
        <label for="categpro" class="form-label">
          Catégorie professionnelle
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <select id="professional_category" class="form-select col-sm-12" formControlName="professional_category">
            <option [value]="">Catégorie professionnelle</option>
            @for (category of categories; track category) {
            <option [value]="category.code">
              {{ category.name }}
            </option>
            }
          </select>
        </div>
        <!-- <div *ngIf="stepThreeForm.controls['professional_category'].invalid && (stepThreeForm.controls['professional_category'].dirty || stepThreeForm.controls['professional_category'].touched)" class="text-danger">
          La Catégorie professionnelle de l'entreprise est requis.
        </div> -->
      </div>
      <div class="row mb-2">
        <label for="subcategory" class="form-label">
          Sous-Catégorie
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 d-flex align-items-center">
          <select id="sub_category" class="form-select col-sm-12" formControlName="sub_category">
            <option [value]="">Sous-Catégorie</option>
            @for (category of categories; track category) {
            <option [value]="category.code">
              {{ category.name }}
            </option>
            }
          </select>
        </div>
        <!-- <div *ngIf="stepThreeForm.controls['sub_category'].invalid && (stepThreeForm.controls['sub_category'].dirty || stepThreeForm.controls['sub_category'].touched)" class="text-danger">
          La sous catégorie de l'entreprise est requis.
        </div> -->
      </div>

      <div class="row mb-2">
        <label for="fixed" class="form-label">
          URL de votre site web(cas échéant)
          <span class="red">*</span>
        </label>
        <div class="col-sm-12">
          <input type="text" class="form-input" id="website" placeholder="URL de votre site web(cas échéant)"
            formControlName="website" />
        </div>
      </div>

      <div class="d-flex mt-5">
        <button type="button" class="btn-custom cancel" (click)="back()">
          annuler
        </button>
        <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepThreeForm.valid">
          suivant
        </button>
      </div>
    </form>
    } @else if(nextStep === StateEnum.Last) {
    <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepFourForm" (ngSubmit)="stepFourFormSubmit()">
      <div class="message fs-27 pb-3">
        <span>inscription - enterprise</span>
      </div>
      <div class="row mb-2 mt-2">
        <label for="password" class="form-label">
          Mot de passe
          <span class="red">*</span>
        </label>
        <div class="col-sm-12 input-group-append">
          <input type="text" class="form-input" id="password"
            placeholder="Saisissez votre mot de passe" formControlName="password" />
          <!-- <span class="eyeicon" (click)="togglePasswordVisibility()">
            <i class="bi" [ngClass]="{
                  'bi-eye': showPassword,
                  'bi-eye-slash': !showPassword,
                }"></i>
          </span> -->
        </div>
      </div>
      <div class="row mb-2">
        <label for="cfrm-password" class="form-label">
          Mot de passe
          <span class="red">*</span>
        </label>
        <div class="col-sm-12">
          <input type="text" class="form-input" id="cfrm-password"
            placeholder="Saisissez votre mot de passe" formControlName="cfrmPassword" />
          <!-- <span class="eyeicon" (click)="togglePasswordVisibility()">
            <i class="bi" [ngClass]="{
                  'bi-eye': showPassword,
                  'bi-eye-slash': !showPassword,
                }"></i>
          </span> -->
          <div *ngIf="stepFourForm.errors?.['mismatch']" class="text-danger">
            Les mots de passe ne correspondent pas.
          </div>
        </div>
      </div>

      <div class="d-flex mt-5">
        <button type="button" class="btn-custom cancel" (click)="back()">
          annuler
        </button>
        <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepFourForm.valid">
          suivant
        </button>
      </div>
    </form>
    }
  </div>
</div>