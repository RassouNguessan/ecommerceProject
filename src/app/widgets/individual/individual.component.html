<div class="container mt-5 bg-white">
  <div class="pt-5">
    <app-sec-msg></app-sec-msg>
    
    <!-- Step One -->
     @if (nextStep === StateEnum.One) {
      <div>
        <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepOneForm" (ngSubmit)="onStepOneSubmit()">
          <div class="message fs-27 pb-3">
            <span>inscription - particulier</span>
          </div>
          
          <div class="row mb-2">
            <label for="first_name" class="form-label">
              Nom
              <span class="red">*</span>
            </label>
            <div class="col-sm-12 d-flex align-items-center">
              <input type="text" class="form-input" id="first_name" placeholder="Saisissez votre nom" formControlName="first_name" />
            </div>
            @if (stepOneForm.controls['first_name'].invalid && stepOneForm.controls['first_name'].touched) {
              <div class="text-danger">
                Le nom est requis.
              </div>
            }
          </div>
          
          <div class="row mb-2">
            <label for="last_name" class="form-label">
              Prénoms
              <span class="red">*</span>
            </label>
            <div class="col-sm-12 d-flex align-items-center">
              <input type="text" class="form-input" id="last_name" placeholder="Saisissez vos prénoms" formControlName="last_name" />
            </div>
            @if (stepOneForm.controls['last_name'].invalid && stepOneForm.controls['last_name'].touched) {
              <div class="text-danger">
                Les prénoms sont requis.
              </div>
            }
          </div>
          
          <div class="row mb-2">
            <label for="birth_day" class="form-label">
              Date de naissance
              <span class="red">*</span>
            </label>
            <div class="col-sm-12">
              <input type="date" class="form-input" id="birth_day" formControlName="birth_day" />
            </div>
            @if (stepOneForm.controls['birth_day'].invalid && stepOneForm.controls['birth_day'].touched) {
              <div class="text-danger">
                La date de naissance est requise.
              </div>
            } 
          </div>
          
          <div class="row mb-2">
            <label for="email" class="form-label">
              E-mail
              <span class="red">*</span>
            </label>
            <div class="col-sm-12 d-flex align-items-center">
              <input type="email" class="form-input" id="email" placeholder="Saisissez votre adresse mail" formControlName="email" />
            </div>
            @if (stepOneForm.controls['email'].invalid && stepOneForm.controls['email'].touched) {
              <div class="text-danger">
                Entrez une adresse email valide.
              </div>
            }
            @if (emailAlreadyExists) {
              <div class="text-danger">
                {{ errorMessage }}
              </div>
            }
          </div>
          
          <div class="row mb-2">
            <label for="phone" class="form-label">
              Numéro de téléphone
              <span class="red">*</span>
            </label>
            <div class="col-sm-12 d-flex align-items-center">
              <input type="text" class="form-input" id="phone" placeholder="+225 00 00 00 00" formControlName="phone" />
            </div>
            @if (stepOneForm.controls['phone'].invalid && stepOneForm.controls['phone'].touched) {
              <div class="text-danger">
                Entrez un numéro de téléphone valide.
              </div>
            }
          </div>
        
          <div class="d-flex mt-5">
            <button type="button" class="btn-custom cancel" routerLink="/register">annuler</button>
            <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepOneForm.valid">suivant</button>
          </div>
        </form>
      </div>
     }
     
    <!-- Step Two -->
     @if (nextStep === StateEnum.Two) {
      <div>
        <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepTwoForm" (ngSubmit)="onStepTwoSubmit()">
          <div class="message fs-27 pb-3">
            <span>inscription - particulier</span>
          </div>
          <div class="d-flex fs-18 fw-bold mt-2">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px" y="0px" width="17px" height="20px" viewBox="0 0 111.811 122.88"
              enable-background="new 0 0 111.811 122.88" xml:space="preserve">
              <g>
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M55.713,0c20.848,13.215,39.682,19.467,55.846,17.989 c2.823,57.098-18.263,90.818-55.63,104.891C19.844,109.708-1.5,77.439,0.083,17.123C19.058,18.116,37.674,14.014,55.713,0L55.713,0 z M41.458,56.508h1.438v-3.331c0-3.689,1.454-7.051,3.797-9.494c2.361-2.462,5.622-3.991,9.214-3.991s6.854,1.529,9.214,3.991 c2.343,2.443,3.797,5.805,3.797,9.494v3.331h1.438c1.167,0,2.123,0.955,2.123,2.123v22.434c0,1.168-0.956,2.123-2.123,2.123H41.458 c-1.168,0-2.123-0.955-2.123-2.123V58.631C39.334,57.463,40.29,56.508,41.458,56.508L41.458,56.508z M54.164,71.286l-2.291,6h8.066 l-2.122-6.082c1.347-0.693,2.268-2.097,2.268-3.716c0-2.308-1.871-4.179-4.179-4.179s-4.178,1.871-4.178,4.179 C51.728,69.173,52.726,70.625,54.164,71.286L54.164,71.286z M46.916,56.508h17.981v-3.331c0-2.623-1.021-4.999-2.666-6.715 c-1.627-1.697-3.866-2.751-6.325-2.751c-2.458,0-4.698,1.054-6.324,2.751c-1.646,1.716-2.666,4.092-2.666,6.715V56.508 L46.916,56.508z" />
              </g>
            </svg>
            <span class="mx-2">Confirmation E-mail.</span>
          </div>
          <div class="my-2 mb-4 fs-16">
            <span>
              Si le remplissage automatique ne se déclenche pas dans
              quelques secondes, saisissez le code que nous avons envoyé
              au {{stepOneForm.value.email}}.
            </span>
          </div>
          <div class="row mb-2">
            <label for="otpcode" class="form-label">
              Code
              <span class="red">*</span>
            </label>
            <div class="col-sm-12">
              <input type="text" class="form-input" id="otpCode" placeholder="Saisissez le code reçu" formControlName="otpCode" />
            </div>
            @if (stepTwoForm.controls['otpCode'].invalid && stepTwoForm.controls['otpCode'].touched) {
                <div class="text-danger">
              Le code OTP est requis.
            </div>
            }
            @if (otpErrorMessage) {
              <div class="text-danger">
                {{ otpErrorMessage }}
              </div>
            }
          </div>
          <div class="d-flex mt-5">
            <button type="button" class="btn-custom cancel" (click)="back()">annuler</button>
            <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepTwoForm.valid">suivant</button>
          </div>
        </form>
      </div>
     }
    

    <!-- Step Three -->
     @if(nextStep === StateEnum.Three){
      <div>
        <form class="p-md-5 p-5 justify-content-between" [formGroup]="stepThreeForm" (ngSubmit)="onStepThreeSubmit()">
          <div class="message fs-30 pb-3">
            <span>Inscription</span>
          </div>
          
          <div class="row mb-2">
            <label for="password" class="form-label">
              Mot de passe
              <span class="red">*</span>
            </label>
            <div class="col-sm-12">
              <input type="password" class="form-input" id="password" placeholder="Saisissez votre mot de passe" formControlName="password" />
            </div>
            @if (stepThreeForm.controls['password'].invalid && stepThreeForm.controls['password'].touched) {
              <div class="text-danger">
                Le mot de passe est requis.
              </div>
            }
          </div>
          
          <div class="row mb-2">
            <label for="cfrmPassword" class="form-label">
              Confirmation du mot de passe
              <span class="red">*</span>
            </label>
            <div class="col-sm-12">
              <input type="password" class="form-input" id="cfrmPassword" placeholder="Confirmez votre mot de passe" formControlName="cfrmPassword" />
            </div>
            @if (stepThreeForm.errors?.['mismatch']) {
              <div class="text-danger">
                Les mots de passe ne correspondent pas.
              </div>
            }
          </div>
  
          <div class="d-flex mt-1">
            <button type="button" class="btn-custom cancel" (click)="back()">annuler</button>
            <button type="submit" class="ms-2 btn-custom next" [disabled]="!stepThreeForm.valid">finaliser</button>
          </div>
        </form>
      </div>
     }
  </div>
</div>
